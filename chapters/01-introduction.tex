\chapter{Introduction}
\label{chp:introduction} 
\section{\label{sec:motivation}Motivation}
With the increasing focus on power consumption and small design-size, hardware manufacturer are forced to develop their products with these parameters in mind. Architectural exploration of hardware plays a vital role in the process of creating integrated circuits with the best trade-offs between speed, area, and power consumption for a given specification. The process of architectural exploration is a tedious and time-consuming process, involving many steps. During the exploration, a number of hardware architectures are built and evaluated based on minimum performance requirements and worst-case operational scenarios. By generating a large number of designs with great diversity, a satisfactory result can be achieved. The number of architectures that can be evaluated is limited by available time and resources. \gls{hls} is a compelling alternative to shorten this process. By reducing the time for creating each design, the number of evaluated designs can be increased, with the potential of generating far more diversity between the architectures than what would ever have been possible by parametrized \gls{rtl}.

On the left side of \cref{fig:motivationflow} a typical design process for a \gls{dsp} application is shown. On the right side, the same design process is shown, using a \gls{hls}-based framework. It can easily be seen that the effort the designer has to put into the process is reduced with the second alternative.

\begin{figure}[hbpt]
\centering
\includegraphics[width=0.75\textwidth]{../figs/Motivation.png}
\caption{\label{fig:motivationflow}Typical DSP design process compared to HLS-framework.}
\end{figure}

The thesis will look at the implementation of a framework for architectural exploration of digital hardware, targeted for \gls{asic} implementation. The ultimate goal is to create a framework that automatically explores a wide variety of architectural variations and presents the best alternatives with regards to a given design goal or constraints.
\section{Previous work}
In my specialization project \cite{holm2015pro}, conducted during the autumn of 2015, I explored the academic open source \gls{hls}-tool \textit{LegUp}. This tool has a maturity not before seen in an academic \gls{hls}-tool, and that it is open-source makes it appealing for the concept of a framework for architectural exploration of hardware. LegUp provides ANSI-C to Verilog high-level synthesis, but their focus is targeted towards implementation on \gls{fpga} architectures. The official target support of the output is limited to a few boards from the \gls{fpga} manufacturer Altera, and beta-support for a single board from Xilinx. This thesis will target \gls{asic} implementations. The findings from \cite{holm2015pro} was that there are some issues with the original version of LegUp, limiting its usability for the desired framework. The issues are mainly related to input and output of the generated modules, structure of memory management, and size of signals. A framework for architectural exploration of hardware, using \gls{hls}, was proposed in \cite{holm2015pro}. An illustration showing the tool- and information-flow of the framework is shown in \cref{fig:frameworkflow}.

\begin{figure}[hbpt]
\centering
\includegraphics[width=0.75\textwidth]{../figs/Framework.png}
\caption{\label{fig:frameworkflow}Proposed framework-solution \cite{holm2015pro}.}
\end{figure}

\section{\label{sec:projectobj}Project objectives}
The initial goals of the specialization project were found to be a bit exaggerated. For this Master's thesis it was decided to focus on a smaller part of the ultimate goal, to get the necessary basics of the \gls{hls}-tool working well, before proceeding with the framework. The main goal of this thesis is therefore to resolve the issues encountered during the specialization project. It is not know if all issues can be resolved, or how time consuming it will be. Other objectives are therefore added in a prioritized order:

\newcommand\litem[1]{\item{\bfseries #1\\}}
\begin{enumerate}
\litem{Explore approaches} Two possible approaches towards resolving the issued, were described in \cite{holm2015pro}. The first step of this thesis will be to explore both these alternatives and look at positive and negative sides of each method. The outcome of this objective will affect the rest of the work with this thesis, making it an important decision. All aspects of the two approaches must therefore be taken into consideration before making a choice.
\litem{Resolve issues} For LegUp to be usable in a framework for architectural exploration, it is vital that the tool is adapted to generated Verilog suitable for \gls{asic} implementation. This objective is thought to be the most time-consuming, and its outcome is very uncertain. However, if completed successfully, the use-space of LegUp can be extended to other concepts. LegUpâ€™s architecture is, like the input language C, quite memory-bound. \gls{ram} modules, memory controllers, and pointers are used for many things where a simple signal could have given the same result. It should be looked into if this memory-architecture can be changed by de-referencing pointers or turn memory elements into generic signals. A proper way of handling inputs and outputs should also be implemented, to avoid being limited to a certain amount of ports on the generated designs.
\litem{Create framework} When the issues have been resolved, the work with creating a framework for architectural exploration can be started. The framework will be based on the flow shown in \cref{fig:frameworkflow}, using various scripts and programs to run the tool-flow, generating constraints, and creating scorefiles. The framework should be easy to use and ideally be able to run without any interactions with the user.
\litem{Proof of concept} To verify and illustrate the concept in action, a proof of concept will be created. By creating one or more reference designs which will be run through the framework, it is expected to get a wide variety of generated designs with varying results in terms of area, power consumption, and performance. The reference design will also be implemented directly in Verilog \gls{hdl}, to compare and calculate the overhead of the \gls{hls}-generated designs.
\litem{Evaluation} Based on the results from the conducted proof of concept, a re-evaluate of LegUp's usefulness in a framework for architectural exploration of digital hardware, will be conducted. This evaluation will be based on the deviation of the results among the generated designs, as well as the overhead compared to the design written in Verilog. Other aspects can also be considered, like how well the adaption of LegUp is performed and how well the generated Verilog \gls{hdl} synthesize for \gls{asic} architectures.
\litem{Techniques for reducing overhead} The typical overhead of \gls{hls}-tools are in the range of 30-40\%. One of the initial objectives of this concept included the integration of  Nordic Semiconductor's coding style and practices, the \gls{ddvc} \cite{nordicddvc}, into LegUp's Verilog libraries. This include things like interfaces, parameters, naming conventions, power/clock domains, etc. It is assumed that this can give a large reduction of the overhead generated by the \gls{hls}-tool, when integrated into Nordic Semiconductor's existing modules.
\end{enumerate}

\section{Contributions}
The intentions of this work have been to create an adapted version of the open source \gls{hls}-tool LegUp, to make it more suited for generating Verilog targeted towards \gls{asic} architectures. It was also time to create a framework for architectural exploration of digital hardware, and to conduct a proof of concept study.

\textbf{The following list summarize the contributions made through this thesis:}
\begin{itemize}
    \item An adapted version of LegUp has been created. The adapted version support features that is important for implementation towards \gls{asic} architectures. This include the possibility of having multiple inputs and outputs in the generated modules, the inputs and outputs can be streaming, eliminating the need for stopping and starting the module for each run, and an improved method of generating testbenches that include all signals and desired testcases.
    \item A framework for architectural exploration of digital hardware has been developed. This framework can generate a large number of architectural variations with great diversity. Area, power and performance information will automatically be extracted from each design, allowing the designer to choose the best architecture for further implementation.
    \item Using a FIR-filter reference design, a proof of concept study has been conducted, showing that the framework can be used for architectural exploration of digital hardware.
    \item LegUp's usability in a framework for architectural exploration of digital hardware has been evaluated, based on results from the proof of concept study and the performance of the adapted version of LegUp.
\end{itemize}

\section{Method}
The work performed in this thesis is based on multiple research methods. Before the problem could be solved, a study of the architecture and structure of LegUp had to be conducted, to understand the connections and information-flow in the tool. This study was primarily carried out during the previous project \cite{holm2015pro}, but also continued into the work with this thesis. A plan for how to resolve each of the issues at hand was devised and discussed before being carried out, to ensure a good solution. The problems at hand requires in-depth knowledge of the libraries in LegUp, but when the source of the issue had been located, fixing the issue was based on trial and error. By replacing a piece of code with some other solution, a new output can be generated and evaluated. This process is repeated until the issue is resolved. The creation of the framework is based on the idea proposed by Isael Diaz. A study of architectural exploration and \gls{hls}-concepts had to be conducted before building the framework, to make sure the output would have the desired diversity. An experimental study of the usefulness of the created framework was conducted as a proof of concept, to check if the initial hypothesis holds. By running a reference design through the framework, a large amount of data was reported. The data was analyzed to draw the conclusion about the hypothesis.

\section{Overview of the thesis}
In general, this thesis is divided into 8 chapters, each presenting one or more of the project objectives described above, in addition to appendix. In \cref{chp:background}, the background and theory required to understand the rest of the thesis is described. Point one and two from the list above is described in \cref{chp:adaptinglegup}. Chapter \ref{chp:toolflowex} uses a design example to present a thorough description of the information-flow in LegUp and the other tools used in the framework. In \cref{chp:createframework} the third objective, the process of creating a framework, is described. The fourth objective, to create a proof of concept, is presented in \cref{chp:frameworkresults}. The evaluation of the proof of concept results, corresponding to the fifth objective, as well as a discussion of LegUp in general, with focus on its usefulness in the created framework, has been presented in \cref{chp:discussion}. Finally the work is summarized and concluded in \cref{chp:conclusion}. \Cref{chp:conclusion} also include a section of future works, describing aspects that will be interesting to look into more detail at in an eventual continuation of this project. Appendix include code-listings of designs and implementations, that are described and discussed in the main chapters.
